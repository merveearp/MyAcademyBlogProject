@using Microsoft.AspNetCore.Identity
@using Blogy.Entity.Entities
@inject SignInManager<AppUser> SignInManager
@inject UserManager<AppUser> UserManager

@{
	Layout = null;
}

<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Untree.co">
	<link rel="shortcut icon" href="favicon.png">

	<meta name="description" content="" />
	<meta name="keywords" content="bootstrap, bootstrap5" />

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;600;700&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="~/UI/fonts/icomoon/style.css">
	<link rel="stylesheet" href="~/UI/fonts/flaticon/font/flaticon.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
	<link rel="stylesheet" href="~/UI/css/tiny-slider.css">
	<link rel="stylesheet" href="~/UI/css/aos.css">
	<link rel="stylesheet" href="~/UI/css/glightbox.min.css">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<link rel="stylesheet" href="~/UI/css/style.css">
	<link rel="stylesheet" href="~/UI/css/flatpickr.min.css">
	<link rel="stylesheet"
		  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">


	<title>Blogy Panel</title>
</head>
<body>

	<div class="site-mobile-menu site-navbar-target">
		<div class="site-mobile-menu-header">
			<div class="site-mobile-menu-close">
				<span class="icofont-close js-menu-toggle"></span>
			</div>
		</div>
		<div class="site-mobile-menu-body"></div>
	</div>

	<nav class="site-nav">
		<div class="container">
			@{
				if (SignInManager.IsSignedIn(User))
				{
					var currentUser = await UserManager.GetUserAsync(User);
					if (currentUser != null)
					{
						var roles = await UserManager.GetRolesAsync(currentUser);

						if (roles.Contains("Admin"))
						{
							@await Component.InvokeAsync("_UILayoutAdminMenuComponent")
						}
						else if (roles.Contains("Writer"))
						{
							@await Component.InvokeAsync("_UILayoutWriterMenuComponent")
						}
						else if (roles.Contains("User"))
						{
							@await Component.InvokeAsync("_UILayoutUserMenuComponent")
						}
						else
						{
							@await Component.InvokeAsync("_UILayoutMenuComponent")
						}
					}
				}
				else
				{
					@await Component.InvokeAsync("_UILayoutMenuComponent")
				}
			}
		</div>
	</nav>

	@RenderBody()

	<footer class="site-footer">
		<div class="container">
			<div class="row">
				@await Component.InvokeAsync("_UILayoutFooterComponent")

				<div class="col-lg-4 ps-lg-5">
					<div class="widget">
						<h3 class="mb-4">Company</h3>
						<ul class="list-unstyled float-start links">
							<li><a href="#">About us</a></li>
							<li><a href="#">Services</a></li>
							<li><a href="#">Vision</a></li>
							<li><a href="#">Mission</a></li>
							<li><a href="#">Terms</a></li>
							<li><a href="#">Privacy</a></li>
						</ul>
						<ul class="list-unstyled float-start links">
							<li><a href="#">Partners</a></li>
							<li><a href="#">Business</a></li>
							<li><a href="#">Careers</a></li>
							<li><a href="#">Blog</a></li>
							<li><a href="#">FAQ</a></li>
							<li><a href="#">Creative</a></li>
						</ul>
					</div>
				</div>

				@await Component.InvokeAsync("_UILayoutRecentBlogsComponent")
			</div>

			<div class="row mt-5">
				<div class="col-12 text-center">
					<p>
						Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a>  Distributed by <a href="https://themewagon.com">Merve Arpacıoğlu Türk </a>
					</p>
				</div>
			</div>
		</div>
	</footer>

	<div id="overlayer"></div>
	<div class="loader">
		<div class="spinner-border text-primary" role="status">
			<span class="visually-hidden">Loading...</span>
		</div>
	</div>

	<script src="~/UI/js/bootstrap.bundle.min.js"></script>
	<script src="~/UI/js/tiny-slider.js"></script>
	<script src="~/UI/js/flatpickr.min.js"></script>
	<script src="~/UI/js/aos.js"></script>
	<script src="~/UI/js/glightbox.min.js"></script>
	<script src="~/UI/js/navbar.js"></script>
	<script src="~/UI/js/counter.js"></script>
	<script src="~/UI/js/custom.js"></script>

	@if (TempData["SuccessMessage"] != null)
	{
		<script>
			Swal.fire({
				toast: true,
				position: 'top-end',
				icon: 'success',
				title: 'Giriş Başarılı!',
				html: '<b>@TempData["UserRole"]</b> olarak giriş yaptınız!',
				showConfirmButton: false,
				timer: 3000,
				timerProgressBar: true,
				background: '#10b981',
				color: '#fff',
				iconColor: '#fff',
				didOpen: (toast) => {
					toast.addEventListener('mouseenter', Swal.stopTimer)
					toast.addEventListener('mouseleave', Swal.resumeTimer)
				}
			});
		</script>
	}

	@if (TempData["ErrorMessage"] != null)
	{
		<script>
			Swal.fire({
				toast: true,
				position: 'top-end',
				icon: 'error',
				title: 'Hata!',
				text: '@TempData["ErrorMessage"]',
				showConfirmButton: false,
				timer: 3000,
				timerProgressBar: true,
				background: '#ef4444',
				color: '#fff',
				iconColor: '#fff'
			});
		</script>
	}

</body>
</html>